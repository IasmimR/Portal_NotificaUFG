define.experiment.Class("wysiwyg.common.behaviors.Animations.AnimationNewBehaviors",function(a,b){var c=a,d=b;c.methods({initialize:d.after(function(){this.utils=this._tweenEngine.utils,this.ClearTypes=this._tweenEngine.ClearTypes}),tween:function(){return this._tweenEngine.tween.apply(this._tweenEngine,arguments)},set:function(a,b,c){return b=b?_.cloneDeep(b):{},b.duration=0,b.delay=0,b.to=b.to||{},this.tween(a,b,c)},saveData:function(a,b,c){a[b]=c,this.set(a,{clearOnComplete:!0})}})}),define.experiment.newClass("wysiwyg.common.behaviors.Transitions.AnimationPageTransitions",function(a){var b=a;b.resources(["W.Config","W.Utils"]),b.fields({_definitions:{transitions:{}}}),b.methods({initialize:function(a){this._animations=a},getTransitionDefinition:function(a){return this._definitions.transitions[a]||(this._definitions.transitions[a]=define.getDefinition("transition",a,!1,this._animations)),this._definitions.transitions[a]||null},getAllTransitionDefinitions:function(){var a=define.getDefinition("transition");return _.forEach(a,function(a,b){this._definitions.transitions[b]||this.getTransitionDefinition(b)},this),this._definitions.transitions},applyTransition:function(a,b,c,d){var e=this.getTransitionDefinition(a);return e?e.init(b,c,d):null},isReady:function(){return this._animations.isReady()},isTweening:function(a){return this._animations.isTweening(a)}})}),define.experiment.Class("wysiwyg.common.behaviors.TweenEngine.AnimationNewBehaviors",function(a,b){var c=a,d=b;c.statics({ClearTypes:{STYLE:"resetStyle",SPLIT_TEXT:"splitText"}}),c.utilize(["wysiwyg.common.behaviors.utilities.SplitHtmlText"]),c.methods({initialize:d.after(function(){this.utils={SplitHtmlText:this.imports.SplitHtmlText}}),tween:function(a,b,c){var d,e;return this.isReady()?(a=_.isArray(a)||a instanceof window.NodeList?_.toArray(a):[a],_.forEach(a,function(a){a.removeClass("hideForAnimation")},this),d=b.data&&b.data.clearParams,d&&d.elements&&_.contains(d.types,this.ClearTypes.STYLE)&&this._saveCssText(d.elements),e="undefined"!=typeof b.stagger,b=this._buildTweenParamsObject(b,c,e),b.from&&b.to?this._fromTo(a,b):b.from?this._from(a,b):b.to?this._to(a,b):(console.log("Missing to/from object in params. no tween started"),void 0)):null},sequence:function(a,b,c){var d;if(!this.isReady())return null;d=b.data&&b.data.clearParams,d&&d.elements&&_.contains(d.types,this.ClearTypes.STYLE)&&this._saveCssText(d.elements),b=this._buildSequenceParamsObject(a,b,c);var e=new this._tweenResource.timeline(b);return e.add(a)},clear:function(a,b){var c,d,e,f,g;if(b=!!b,!this.isReady())return null;if(_.isArray(a))for(g=0;g<a.length;g++)this.clear(a[g],!0);else if(a instanceof this._tweenResource.timeline){if(e=a,e.pause(),f=e.data&&e.data.clearParams,!f)return this.clear(e.getChildren(!1,!0,!0),!1),void 0;this._clearElementByTypes(f),e.clear(),d=e.getChildren(!0,!0,!1)}else a instanceof this._tweenResource.tween&&(c=a,d=[c],f=c.data.clearParams,c.pause(),c.kill(),f&&this._clearElementByTypes(f));b||this.resources.W.Commands.executeCommand("TweenEngine.AnimationInterrupted",{type:"TweenEngine.AnimationInterrupted",src:a,timeline:e,tweens:d},"TweenEngine")},_clearElementByTypes:function(a){var b,c,d;if(d=a.elements instanceof HTMLElement?[a.elements]:a.elements,_.contains(a.types,this.ClearTypes.STYLE))for(c=0;c<d.length;c++)b=d[c],this._resetElementStyles(b);if(_.contains(a.types,this.ClearTypes.SPLIT_TEXT))for(c=0;c<d.length;c++)b=d[c],this._resetSplitText(b)},_resetSplitText:function(a){var b=new this.utils.SplitHtmlText;b.revert(a)},_resetElementStyles:function(a){var b=a._gsCssText,c=a.$logic;"undefined"!=typeof b&&(c&&(b=this._updateCssText(b,{top:c.getY()+"px"})),delete a._gsCssText,this._tweenResource.set(a,{clearProps:"all"}),a.style.cssText=b)},_saveCssText:function(a){var b,c;for(a=a instanceof HTMLElement?[a]:a,c=0;c<a.length;c++)b=a[c],"undefined"==typeof b._gsCssText&&(b._gsCssText=b.style.cssText)},_from:function(a,b){var c,d,e,f,g,h,i;return c=b.duration,g=b.stagger,i=b.delay,d=_.defaults(b,b.from),d.data=d.data||{},delete d.from,delete d.duration,delete d.stagger,"undefined"!=typeof g?(h=d.data,d.data={},delete d.delay,e=this._tweenResource.staggerFrom(a,c,d,g),f=this.sequence(e,{clearOnComplete:d.clearOnComplete,data:h,delay:i})):e=this._tweenResource.from(a,c,d),f||e},_to:function(a,b){var c,d,e,f,g,h,i;return c=b.duration,g=b.stagger,i=b.delay,d=_.defaults(b,b.to),d.data=d.data||{},delete d.to,delete d.duration,delete d.stagger,"undefined"!=typeof g?(h=d.data,d.data={},delete d.delay,e=this._tweenResource.staggerTo(a,c,d,g),f=this.sequence(e,{clearOnComplete:d.clearOnComplete,data:h,delay:i})):e=this._tweenResource.to(a,c,d),f||e},_fromTo:function(a,b){var c,d,e,f,g,h,i,j;return e=b.duration,d=b.from,h=b.stagger,j=b.delay,c=_.defaults(b,b.to),c.data=c.data||{},delete c.to,delete c.from,delete c.duration,delete c.stagger,"undefined"!=typeof h?(i=c.data,c.data={},delete c.delay,f=this._tweenResource.staggerFromTo(a,e,d,c,h),g=this.sequence(f,{clearOnComplete:c.clearOnComplete,data:i,delay:j})):f=this._tweenResource.fromTo(a,e,d,c),g||f},_buildTweenParamsObject:function(a,b,c){return a=a||{},a=this._validateAnimationParams(a,[b,this._allowedTweenMaxParamsList]),a.data=a.data||{},c||(a.onComplete=this._onCompleteEvent,a.onCompleteParams=["{self}"],a.onStart=this._onStartEvent,a.onStartParams=["{self}"],a.fireUpdateCommand&&(a.onUpdate=this._onUpdateEvent,a.onUpdateParams=["{self}"]),a.data.clearOnComplete=a.clearOnComplete||!1),delete a.clearOnComplete,a},_buildSequenceParamsObject:function(a,b,c){return b=b||{},b=this._validateAnimationParams(b,[c,this._allowedTimelineMaxParamsList]),b.data=b.data||{},b.onComplete=this._onCompleteEvent,b.onCompleteParams=["{self}"],b.onStart=this._onStartEvent,b.onStartParams=["{self}"],b.fireUpdateCommand&&(b.onUpdate=this._onUpdateEvent,b.onUpdateParams=["{self}"]),b.data.clearOnComplete=b.clearOnComplete||!1,delete b.clearOnComplete,b}})}),define.experiment.newAnimation("3DAnimation1.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){d=d?_.cloneDeep(d):{};var e="cw"===d.direction?1:-1;return d.from=d.from||{},d.from.rotationX=90*e,d.perspective=_.isNumber(d.perspective)?d.perspective:800,d.transformOrigin="center "+d.origin,d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},this._animations.sequence([this._animations.applyTween("BaseFade",a,b/2,c,{from:{opacity:0}}),this._animations.applyTween("BaseRotate3D",a,b,c,d)],d)},group:["entrance","3d"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0}}}),define.experiment.newAnimation("3DAnimation2.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){d=d?_.cloneDeep(d):{};var e="cw"===d.direction?1:-1;return d.from=d.from||{},d.from.rotationX=90*e,d.perspective=_.isNumber(d.perspective)?d.perspective:800,d.transformOrigin="center "+d.origin,d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},this._animations.sequence([this._animations.applyTween("BaseFade",a,b/2,c,{from:{opacity:0}}),this._animations.applyTween("BaseRotate3D",a,b,c,d)],d)},group:["entrance","3d"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0}}}),define.experiment.newAnimation("3DAnimation3.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){d=d?_.cloneDeep(d):{};var e="cw"===d.direction?1:-1;return d.from=d.from||{},d.from.rotationX=90*e,d.perspective=_.isNumber(d.perspective)?d.perspective:800,d.transformOrigin="center "+d.origin,d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},this._animations.sequence([this._animations.applyTween("BaseFade",a,b/2,c,{from:{opacity:0}}),this._animations.applyTween("BaseRotate3D",a,b,c,d)],d)},group:["entrance","3d"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0}}}),define.experiment.newAnimation("3DAnimation4.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){d=d?_.cloneDeep(d):{};var e="cw"===d.direction?1:-1;return d.from=d.from||{},d.from.rotationX=90*e,d.perspective=_.isNumber(d.perspective)?d.perspective:800,d.transformOrigin="center "+d.origin,d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},this._animations.sequence([this._animations.applyTween("BaseFade",a,b/2,c,{from:{opacity:0}}),this._animations.applyTween("BaseRotate3D",a,b,c,d)],d)},group:["entrance","3d"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0}}}),define.experiment.animation("ExpandIn.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){return d=d?_.cloneDeep(d):{},d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},this._animations.sequence([this._animations.applyTween("BaseFade",a,b,c,{from:{opacity:0},ease:"Cubic.easeIn"}),this._animations.applyTween("BaseScale",a,b,c,{from:{scale:0},ease:"Sine.easeOut"})],d)},group:["entrance"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0}}}),define.experiment.animation("FadeIn.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){return d=d?_.cloneDeep(d):{},d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},this._animations.sequence([this._animations.applyTween("BaseFade",a,b,c,{from:{opacity:0},ease:"Cubic.easeIn"})],d)},group:["entrance"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0}}}),define.experiment.newAnimation("FadeOut.AnimationPageTransitions",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){return d=d?_.cloneDeep(d):{},d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},this._animations.sequence([this._animations.applyTween("BaseFade",a,b,c,{to:{opacity:0},ease:"Cubic.easeIn"})],d)},group:["exit"],options:{hideOnStart:!1}}}),define.experiment.newAnimation("Flip3DHorizontal.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){d=d?_.cloneDeep(d):{};var e="cw"===d.direction?1:-1,f={};return f.from=d.from||{},f.from.rotationX=90*e,f.perspective=_.isNumber(d.perspective)?d.perspective:800,f.transformOrigin="center "+d.origin,d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},delete d.from,delete d.direction,delete d.origin,delete d.perspective,this._animations.sequence([this._animations.applyTween("BaseFade",a,b/2,c,{from:{opacity:0}}),this._animations.applyTween("BaseRotate3D",a,b,c,f)],d)},group:["entrance","3d"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0}}}),define.experiment.newAnimation("Flip3DVertical.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){d=d?_.cloneDeep(d):{};var e="cw"===d.direction?1:-1,f={};return f.from=d.from||{},f.from.rotationY=90*e,f.perspective=_.isNumber(d.perspective)?d.perspective:800,f.transformOrigin=d.origin+" center",d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},delete d.from,delete d.direction,delete d.origin,delete d.perspective,this._animations.sequence([this._animations.applyTween("BaseFade",a,b/2,c,{from:{opacity:0}}),this._animations.applyTween("BaseRotate3D",a,b,c,f)],d)},group:["entrance","3d"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0}}}),define.experiment.animation("FloatIn.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){var e,f,g,h,i,j;return d=d?_.cloneDeep(d):{},d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},j=(d.direction||"").trim().toLowerCase(),j=j in this._paramsMap?j:this._defaults.direction,i=this._paramsMap[j],h={width:window.getSize().x,height:window.getSize().y},g=a.getBoundingClientRect(),f=i.dy*i.distance,e=i.dx*(i.dx>0?Math.max(0,Math.min(h.width-g.right,i.distance)):Math.max(0,Math.min(g.left,i.distance))),delete d.direction,this._animations.sequence([this._animations.applyTween("BaseFade",a,b,c,{from:{opacity:0},ease:"Cubic.easeIn"}),this._animations.applyTween("BasePosition",a,b,c,{from:{x:e,y:f},ease:"Sine.easeOut"})],d)},group:["entrance"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0},_defaults:{direction:"right"},_paramsMap:{left:{dx:"-1",dy:"0",distance:"120"},right:{dx:"1",dy:"0",distance:"120"},top:{dx:"0",dy:"-1",distance:"60"},bottom:{dx:"0",dy:"1",distance:"60"}}}}),define.experiment.animation("FlyIn.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){var e,f,g,h,i,j;return d=d?_.cloneDeep(d):{},d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},j=(d.direction||this._defaults.direction).trim().toLowerCase(),i=this._parseParams(j.split(" ")),h={width:window.getSize().x,height:window.getSize().y},g=a.getBoundingClientRect(),f=i.dx>0?h.width-g.right:i.dx*g.left,e=i.dy>0?h.height-g.top:i.dy*g.bottom,delete d.direction,this._animations.sequence([this._animations.applyTween("BaseFade",a,b,c,{from:{opacity:0},ease:"Linear.easeIn"}),this._animations.applyTween("BasePosition",a,b,c,{from:{x:f,y:e},ease:"Sine.easeOut"})],d)},group:["entrance"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0},_defaults:{direction:"right"},_paramsMap:{top:{dy:"-1"},bottom:{dy:"1"},left:{dx:"-1"},right:{dx:"1"}},_parseParams:function(a){var b={dx:0,dy:0};return _.forEach(a,function(a){this._paramsMap[a]&&_.assign(b,this._paramsMap[a])},this),b}}}),define.experiment.animation("SpinIn.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){var e,f,g,h;return d=d?_.cloneDeep(d):{},d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},h=(d.direction||"").trim().toLowerCase(),h=h in this._paramsMap?h:this._defaults.direction,g=isNaN(d.cycles)?this._defaults.cycles:d.cycles,f=_.clone(this._paramsMap[h]),e=(f.direction>0?"+=":"-=")+360*g,delete d.direction,delete d.cycles,this._animations.sequence([this._animations.applyTween("BaseFade",a,b,c,{from:{opacity:0},ease:"Sine.easeIn"}),this._animations.applyTween("BaseScale",a,b,c,{from:{scale:0},ease:"Sine.easeOut"}),this._animations.applyTween("BaseRotate",a,b,c,{from:{rotation:e}})],d)},group:["entrance"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0},_defaults:{direction:"cw",cycles:"5"},_paramsMap:{cw:{direction:"-1"},ccw:{direction:"1"}}}}),define.experiment.newAnimation("TextFlyIn.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){d=d?_.cloneDeep(d):{};var e,f=new this._animations.utils.SplitHtmlText(a);switch(d.split){case"randomWords":e=_.shuffle(f.words());break;case"randomLetters":e=_.shuffle(f.letters());break;case"words":e=f.words();break;case"letters":e=f.letters();break;default:e=f.letters()}var g=this._paramsMap.speed[b],h=this._paramsMap.direction[d.direction];return d.data=d.data||{},d.data.clearParams={elements:[a],types:[this._animations.ClearTypes.SPLIT_TEXT]},delete d.direction,delete d.split,delete d.shuffle,this._animations.sequence([this._animations.applyTween("BaseFade",e,g.duration,c,{from:{opacity:0},stagger:g.stagger}),this._animations.applyTween("BasePosition",e,g.duration,c,{from:{x:h.x,y:h.y},stagger:g.stagger})],d)},group:["entrance","text"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0},_paramsMap:{speed:[{duration:.5,stagger:.05},{duration:.3,stagger:.03},{duration:.1,stagger:.01},{duration:.1,stagger:.005}],direction:{left:{x:-300},right:{x:300},bottom:{y:300},top:{y:-300}}}}}),define.experiment.newAnimation("TextFusilli.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){d=d?_.cloneDeep(d):{};var e=new this._animations.utils.SplitHtmlText(a),f=e.root(),g=e.letters(),h=this._paramsMap.speed[b];return d.data=d.data||{},d.data.clearParams={elements:[a],types:[this._animations.ClearTypes.SPLIT_TEXT]},delete d.duration,this._animations.sequence([this._animations.set(f,{perspective:400}),this._animations.applyTween("BaseFade",g,h.duration,c,{from:{opacity:0},ease:"Back.easeOut",stagger:h.stagger}),this._animations.applyTween("BaseScale",g,h.duration,c,{from:{scale:4},ease:"Back.easeOut",stagger:h.stagger}),this._animations.applyTween("BaseRotate3D",g,h.duration,c,{from:{rotationX:-180,transformOrigin:"100% 50%"},ease:"Back.easeOut",stagger:h.stagger})],d)},group:["entrance","text"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0},_paramsMap:{speed:[{duration:1.7,stagger:.04},{duration:1.2,stagger:.03},{duration:.6,stagger:.02},{duration:.3,stagger:.01}]}}}),define.experiment.newAnimation("TextRollIn.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){d=d?_.cloneDeep(d):{};var e=new this._animations.utils.SplitHtmlText(a),f=e.letters(),g=this._paramsMap.speed[b];return d.data=d.data||{},d.data.clearParams={elements:[a],types:[this._animations.ClearTypes.SPLIT_TEXT]},this._animations.sequence([this._animations.applyTween("BaseFade",f,g.duration,c,{from:{opacity:0},stagger:g.stagger}),this._animations.applyTween("BasePosition",f,g.duration,c,{from:{x:"-20"},stagger:g.stagger}),this._animations.applyTween("BaseRotate",f,g.duration,c,{from:{rotation:-120},stagger:g.stagger})],d)},group:["entrance","text"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0},_paramsMap:{speed:[{duration:1.5,stagger:.06},{duration:1,stagger:.04},{duration:.75,stagger:.02},{duration:.5,stagger:.01}]}}}),define.experiment.newAnimation("TextScrabble.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){var e,f,g,h;d=d?_.cloneDeep(d):{};var i=new this._animations.utils.SplitHtmlText(a);return"words"===d.split?(h=i.words(),g=this._paramsMap.words.speed[b],e=this._paramsMap.words.scale,f=this._paramsMap.words.scaleEase):(h=i.letters(),g=this._paramsMap.letters.speed[b],e=this._paramsMap.letters.scale,f=this._paramsMap.letters.scaleEase),h=_.shuffle(h),d.data=d.data||{},d.data.clearParams={elements:[a],types:[this._animations.ClearTypes.SPLIT_TEXT,this._animations.ClearTypes.STYLE]},delete d.duration,delete d.split,delete d.sort,this._animations.sequence([this._animations.applyTween("BaseFade",h,g.duration,c,{from:{opacity:0},ease:"Power1.easeOut",stagger:g.stagger}),this._animations.applyTween("BaseScale",h,g.duration,c,{from:{scale:e},ease:f,stagger:g.stagger})],d)},group:["entrance","text"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0},_paramsMap:{words:{speed:[{duration:2,stagger:.05},{duration:1.3,stagger:.03},{duration:1,stagger:.02},{duration:.5,stagger:.01}],scale:2,scaleEase:"Back.easeOut"},letters:{speed:[{duration:1.5,stagger:.02},{duration:1,stagger:.013},{duration:.75,stagger:.01},{duration:.5,stagger:.007}],scale:3,scaleEase:"Bounce.easeOut"}}}}),define.experiment.newAnimation("TextTypewriter.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){d=d?_.cloneDeep(d):{};var e=new this._animations.utils.SplitHtmlText(a),f=e.letters(),g=this._paramsMap.speed[b];return d.data=d.data||{},d.data.clearParams={elements:[a],types:[this._animations.ClearTypes.SPLIT_TEXT]},delete d.split,this._animations.sequence([this._animations.applyTween("BaseFade",f,g.duration,c,{from:{opacity:0},ease:"Linear.easeNone",stagger:g.stagger})],d)},group:["entrance","text"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0},_paramsMap:{speed:[{duration:.1,stagger:.15},{duration:.05,stagger:.085},{duration:0,stagger:.04},{duration:0,stagger:.02}]}}}),define.experiment.newAnimation("TextWave.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){d=d?_.cloneDeep(d):{};var e=new this._animations.utils.SplitHtmlText(a),f=e.letters(),g=e.root(),h=this._paramsMap.speed[b];return d.data=d.data||{},d.data.clearParams={elements:[a],types:[this._animations.ClearTypes.SPLIT_TEXT]},delete d.duration,this._animations.sequence([this._animations.set(g,{perspective:400}),this._animations.applyTween("BaseFade",f,h.duration,c,{from:{opacity:0},ease:"Back.easeOut",stagger:h.stagger}),this._animations.applyTween("BaseScale",f,h.duration,c,{from:{scale:0},ease:"Back.easeOut",stagger:h.stagger}),this._animations.applyTween("BaseRotate3D",f,h.duration,c,{from:{rotationX:180,transformOrigin:"0% 50% -50"},ease:"Back.easeOut",stagger:h.stagger})],d)},group:["entrance","text"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0},_paramsMap:{speed:[{duration:1.5,stagger:.02},{duration:1,stagger:.013},{duration:.75,stagger:.01},{duration:.5,stagger:.007}]}}}),define.experiment.animation("TurnIn.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){var e,f,g,h,i,j,k,l;return d=d?_.cloneDeep(d):{},d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},l=(d.direction||"").trim().toLowerCase(),l=l in this._paramsMap?l:this._defaults.direction,k=this._paramsMap[l],j={width:window.getSize().x,height:window.getSize().y},i=a.getBoundingClientRect(),h=k.dx>0?j.width-i.right:k.dx*i.left,g=Math.min(-1.5*i.height,Math.max(-300,-5.5*i.height)),e=(k.dx>0?"+=":"-=")+k.angle,f=[{x:k.dx*i.width,y:g},{x:h,y:g}],delete d.direction,this._animations.sequence([this._animations.applyTween("BaseFade",a,b,c,{from:{opacity:0},ease:"Linear.easeIn"}),this._animations.applyTween("BasePosition",a,b,c,{from:{bezier:{values:f,type:"soft"}},ease:"Sine.easeOut"}),this._animations.applyTween("BaseRotate",a,b,c,{from:{rotation:e}})],d)},group:["entrance"],options:{hideOnStart:!0,screenInThreshold:"15%",waitForPageTransition:!0},_defaults:{direction:"right"},_paramsMap:{left:{dx:"-1",angle:"90"},right:{dx:"1",angle:"90"}}}}),define.experiment.animation("BaseFade.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){return d=d?_.cloneDeep(d):{},d.duration=_.isNumber(parseFloat(b))?b:this._defaults.duration,d.delay=_.isNumber(parseFloat(c))?c:this._defaults.delay,d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},this._animations.tween(a,d,this._allowedParams)},_defaults:{duration:1,delay:0},_allowedParams:["opacity"],group:["base"]}}),define.experiment.animation("BasePosition.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){return d=d?_.cloneDeep(d):{},d.duration=_.isNumber(parseFloat(b))?b:this._defaults.duration,d.delay=_.isNumber(parseFloat(c))?c:this._defaults.delay,d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},this._animations.tween(a,d,this._allowedParams)},_defaults:{duration:1,delay:0},_allowedParams:["left","top","x","y","bezier"],group:["base"]}}),define.experiment.newAnimation("BaseRotate3D.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){d=d?_.cloneDeep(d):{},d.duration=_.isNumber(parseFloat(b))?b:this._defaults.duration,d.delay=_.isNumber(parseFloat(c))?c:this._defaults.delay,d=_.defaults(d,this._defaults.params);var e=d.perspective;return delete d.perspective,d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},this._animations.sequence([this._animations.tween(a,d,this._allowedParams),this._animations.set(a,{transformPerspective:e},this._allowedParams)],{data:d.data})},_defaults:{duration:1,delay:0,params:{perspective:0}},_allowedParams:["rotationX","rotationY","rotationZ","transformPerspective"],group:["base","3d"]}}),define.experiment.animation("BaseRotate.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){return d=d?_.cloneDeep(d):{},d.duration=_.isNumber(parseFloat(b))?b:this._defaults.duration,d.delay=_.isNumber(parseFloat(c))?c:this._defaults.delay,d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},this._animations.tween(a,d,this._allowedParams)},_defaults:{duration:1,delay:0},_allowedParams:["rotation"],group:["base"]}}),define.experiment.animation("BaseScale.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){return d=d?_.cloneDeep(d):{},d.duration=_.isNumber(parseFloat(b))?b:this._defaults.duration,d.delay=_.isNumber(parseFloat(c))?c:this._defaults.delay,d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},this._animations.tween(a,d,this._allowedParams)},_defaults:{duration:1,delay:0},_allowedParams:["scale"],group:["base"]}}),define.experiment.newAnimation("BaseScroll.AnimationPageTransitions",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){return d=d?_.cloneDeep(d):{},d.duration=_.isNumber(parseFloat(b))?b:this._defaults.duration,d.delay=_.isNumber(parseFloat(c))?c:this._defaults.delay,d=_.defaults(d,this._defaults.params),this._animations.sequence([this._animations.tween(a,d,this._allowedParams)])},_defaults:{duration:1,delay:0,params:{scrollTo:{x:0,y:0}}},_allowedParams:["scrollTo","autoKill"],group:["base"]}}),define.experiment.animation("BaseSkew.AnimationNewBehaviors",function(){return{init:function(a){this._animations=a},animate:function(a,b,c,d){return d=d?_.cloneDeep(d):{},d.duration=_.isNumber(parseFloat(b))?b:this._defaults.duration,d.delay=_.isNumber(parseFloat(c))?c:this._defaults.delay,d.data=d.data||{},d.data.clearParams={elements:a,types:[this._animations.ClearTypes.STYLE]},this._animations.tween(a,d,this._allowedParams)},_defaults:{duration:1,delay:0},_allowedParams:["skewX","skewY"],group:["base"]}}),define.experiment.newTransition("CrossFade.AnimationPageTransitions",function(a){return{init:function(a,b,c){return c=c||{},c.reverse?this._reverseTransition(a,b,c):this._transition(a,b,c)},_transition:function(b,c,d){var e=d.duration||this.defaults.duration,f=window.getScrollTop();return a.sequence([a.applyTween("FadeOut",c,e,0,{ease:"Power3.easeInOut"}),a.applyTween("FadeIn",b,e,0,{ease:"Power3.easeInOut"}),a.applyTween("BasePosition",b,0,0,{to:{top:f}})],{clearOnComplete:!0})},_reverseTransition:function(a,b,c){this._transition(a,b,c)},legacyTypes:["crossfade","shrinkfade"],defaults:{duration:1.2},options:{completeCommandOffset:"-=0.4"}}}),define.experiment.newTransition("OutIn.AnimationPageTransitions",function(a){return{init:function(a,b,c){return c=c||{},c.reverse?this._reverseTransition(a,b,c):this._transition(a,b,c)},_transition:function(b,c,d){var e=d.duration||this.defaults.duration,f=e/2,g=window.getScrollTop();return a.sequence([a.applyTween("FadeOut",c,f,0,{ease:"Power3.easeIn"}),a.applyTween("FadeIn",b,f+.1,f-.1,{ease:"Power3.easeOut"}),a.applyTween("BasePosition",b,0,0,{to:{top:g}})],{clearOnComplete:!0})},_reverseTransition:function(a,b,c){this._transition(a,b,c)},legacyTypes:["outIn"],defaults:{duration:1.5},options:{completeCommandOffset:"-=0.4"}}}),define.experiment.newTransition("SwipeHorizontal.AnimationPageTransitions",function(a){return{init:function(a,b,c){return c=c||{},c.reverse?this._reverseTransition(a,b,c):this._transition(a,b,c)},_transition:function(b,c,d){var e=d.duration||this.defaults.duration,f=parseInt(W.Viewer.getDocWidth(),10),g=window.innerWidth,h=(g-f)/2,i=window.getScrollTop();return a.sequence([a.applyTween("BasePosition",c,e,0,{to:{left:-1*(h+f)},ease:"Power1.easeInOut"}),a.applyTween("BasePosition",b,e,0,{from:{left:g-h},ease:"Power1.easeInOut"}),a.applyTween("BasePosition",b,0,0,{to:{top:i}})],{clearOnComplete:!0})},_reverseTransition:function(b,c,d){var e=d.duration||this.defaults.duration,f=parseInt(W.Viewer.getDocWidth(),10),g=window.innerWidth,h=(g-f)/2,i=window.getScrollTop();return a.sequence([a.applyTween("BasePosition",c,e,0,{to:{left:h+f},ease:"Power3.easeInOut"}),a.applyTween("BasePosition",b,e,0,{from:{left:-1*(g-h)},ease:"Power3.easeInOut"}),a.applyTween("BasePosition",b,0,0,{to:{top:i}})],{clearOnComplete:!0})},legacyTypes:["swipeHorizontal","swipeHorizontalFullScreen"],defaults:{duration:1.1},options:{completeCommandOffset:"-=0.8"}}}),define.experiment.newTransition("SwipeVertical.AnimationPageTransitions",function(a){return{init:function(a,b,c){return c=c||{},c.reverse?this._reverseTransition(a,b,c):this._transition(a,b,c)},_transition:function(b,c,d){var e=d.duration||this.defaults.duration,f=window.innerHeight,g=b.getHeight(),h=b.getTop();return h=-1*Math.max(f,g+h),a.sequence([a.applyTween("BasePosition",c,e,0,{to:{top:f},ease:"Power3.easeInOut"}),a.applyTween("BasePosition",b,e,0,{from:{top:h},ease:"Power3.easeInOut"}),a.applyTween("BaseScroll",document.body,e,0,{to:{scrollTo:{y:0}},ease:"Power3.easeInOut"})],{clearOnComplete:!0})},_reverseTransition:function(b,c,d){var e=d.duration||this.defaults.duration,f=window.innerHeight,g=c.getHeight(),h=c.getTop(),i=Math.max(f,g+h);return a.sequence([a.applyTween("BasePosition",c,e,0,{to:{top:-1*(g+h)},ease:"Power3.easeInOut"}),a.applyTween("BasePosition",b,e,0,{from:{top:i},ease:"Power3.easeInOut"}),a.applyTween("BaseScroll",document.body,e,0,{to:{scrollTo:{y:0}},ease:"Power3.easeInOut"})],{clearOnComplete:!0})},legacyTypes:["swipeVertical","swipeVerticalFullScreen"],defaults:{duration:1.1},options:{completeCommandOffset:"-=0"}}}),resource.getResourceValue("W.Experiments",function(a){a.isExperimentOpen("AnimationNewBehaviors")&&define.resource("AnimationDialogMap",{groups:{basic:["FadeIn","FloatIn","ExpandIn","SpinIn","FlyIn","TurnIn"],advanced:["Flip3DVertical","Flip3DHorizontal","3DAnimation1","3DAnimation2","3DAnimation3","3DAnimation4"],text:["TextWave","TextFusilli","TextScrabble","TextRollIn","TextTypewriter","TextFlyIn"]},defaultGroups:["basic"],components:{"wysiwyg.viewer.components.WRichText":["text","basic"]}})}),define.experiment.newClass("wysiwyg.common.behaviors.utilities.SplitHtmlText.AnimationNewBehaviors",function(a){var b=a;b.resources(["W.Utils"]),b.statics({_matchTagsWordsSpaces:new RegExp("(<[^>]*>)|([^\\s<>]+)|(\\s+)","g"),_matchStartTag:new RegExp("(<[^/][^>]*>)"),_matchCloseTag:new RegExp("(</[^>]*>)"),_matchTagName:new RegExp("<\\/?(\\w+)"),_matchSpace:new RegExp("[^\\S+]"),_matchDoubleSpaces:new RegExp("\\s{2,}","g"),_matchCarriageReturns:new RegExp("[\\n\\r\\f]+","g"),_matchEntityOrChar:new RegExp("(&[\\w\\d]+;)|.","g"),_tags:{space:"space",word:"word",letter:"letter"},_isInSpace:!1,_isInWord:!1,_inlines:["a","abbr","acronym","applet","b","basefont","bdo","big","br","button","cite","code","del","dfn","em","font","i","iframe","img","input","ins","kbd","label","map","object","q","s","samp","script","select","small","span","strike","strong","sub","sup","textarea","tt","u","var"],_blocks:["address","article","applet","aside","audio","blockquote","button","canvas","center","dd","del","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frameset","h1","h2","h3","h4","h5","h6","header","hgroup","hr","iframe","ins","isindex","li","map","menu","noframes","noscript","object","ol","output","p","pre","section","script","table","tbody","td","tfoot","th","thead","tr","ul","video"],_empties:["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param","embed"],_splitTextElementIdPrefix:"splitTextElementIdPrefix_",_splitTextElementIdSuffix:"_splitTextElementIdSuffix",_splitTextHiddenClass:"splitTextHidden"}),b.methods({initialize:function(a){this._space={openTag:"<"+this._tags.space+">",closeTag:"</"+this._tags.space+">"},this._word={openTag:"<"+this._tags.word+">",closeTag:"</"+this._tags.word+">"},this._letter={openTag:"<"+this._tags.letter+">",closeTag:"</"+this._tags.letter+">",openSpaceTag:"<"+this._tags.letter+'class="'+this._tags.space+'">'},this.clear(a),a&&this.parse(a)
},parse:function(a){this._rootNode=a,this._rootNode.removeClass("hideForAnimation"),a.id||(a.id=this._splitTextElementIdPrefix+this.resources.W.Utils.getGUID()),this._splitNode=a.cloneNode(!1),this._splitNode.removeAttribute("comp"),this._splitNode.removeAttribute("skin"),this._splitNode.setAttribute("id",this._splitNode.id+this._splitTextElementIdSuffix),this._originalHTML=a.innerHTML,this._splitNode.innerHTML=this._getParsedHtml(this._originalHTML),this._rootNode.parentNode.insertBefore(this._splitNode,this._rootNode),this._rootNode.addClass(this._splitTextHiddenClass),this._lettersNodeList=this._splitNode.getElements(this._tags.letter),this._wordsNodeList=this._splitNode.getElements(this._tags.word),this._paragraphsNodeList=this._splitNode.getElements(">p, >h1, >h2, >h3, >h4, >h5, >h6, li")},root:function(){return this._splitNode||null},originalRoot:function(){return this._rootNode||null},letters:function(){return this._lettersNodeList?Array.prototype.slice.call(this._lettersNodeList):[]},words:function(){return this._wordsNodeList?Array.prototype.slice.call(this._wordsNodeList):[]},paragraphs:function(){return this._paragraphsNodeList?Array.prototype.slice.call(this._paragraphsNodeList):[]},revert:function(a){var b;a=a||this._rootNode,a&&(b=this._splitNode&&this._splitNode.nextSibling===a?this._splitNode:document.getElementById(a.id+this._splitTextElementIdSuffix),b&&(b.parentNode.removeChild(b),a.removeClass(this._splitTextHiddenClass),0===a.id.indexOf(this._splitTextElementIdPrefix)&&(a.id="")))},clear:function(a){this.revert(a),this._rootNode=null,this._splitNode=null,this._originalHTML=null,this._lettersNodeList=null,this._wordsNodeList=null,this._paragraphsNodeList=null},getOriginalHTML:function(){return this._originalHTML||""},isReady:function(){return!0},_getParsedHtml:function(a){var b=this._arrayFromHtmlTextWordsAndTags(a);return b=this._expendInlineTagsToWrapIndividualWords(b),b=this._splitToWordsAndLetters(b),b.join("")},_arrayFromHtmlTextWordsAndTags:function(a){return a=this._trimRedundantSpaces(a),a.match(this._matchTagsWordsSpaces)},_expendInlineTagsToWrapIndividualWords:function(a){var b,c,d=[],e=[],f=[];for(b=0;b<a.length;b++)if(c=a[b],this._matchStartTag.test(c)){var g=c.match(this._matchTagName)[1];this._blocks.indexOf(g)>-1?d.push(c):this._empties.indexOf(g)>-1?d.push(c):(e.push(c),f.unshift("</"+g+">"))}else c===f[0]?(e.pop(),f.shift()):this._matchSpace.test(c)?d=d.concat(this._space.openTag,e,[c],f,this._space.closeTag):""!==c&&(d=d.concat(e,[c],f));return d},_splitToWordsAndLetters:function(a){var b,c,d=[];for(b=0;b<a.length;b++)c=a[b],this._matchStartTag.test(c)?this._splitToWordsHandleStartTag(c,d):this._matchCloseTag.test(c)?this._splitToWordsHandleCloseTag(c,d):this._splitToWordsHandleText(c,d);return d},_splitToWordsHandleStartTag:function(a,b){var c=a.match(this._matchTagName)[1];this._blocks.indexOf(c)>-1&&this._isInWord&&(b.push(this._word.closeTag),this._isInWord=!1),this._empties.indexOf(c)>-1&&this._isInWord?(b.push(this._word.closeTag),this._isInWord=!1):this._inlines.indexOf(c)>-1&&!this._isInWord&&!this._isInSpace?(b.push(this._word.openTag),this._isInWord=!0):c===this._tags.space&&(this._isInWord&&(b.push(this._word.closeTag),this._isInWord=!1),this._isInSpace=!0),b.push(a)},_splitToWordsHandleCloseTag:function(a,b){var c=a.match(this._matchTagName)[1];this._blocks.indexOf(c)>-1&&this._isInWord&&(b.push(this._word.closeTag),this._isInWord=!1),c===this._tags.space&&(this._isInSpace=!1),b.push(a)},_splitToWordsHandleText:function(a,b){this._matchSpace.test(a)?(this._isInWord&&b.push(this._word.closeTag),b.push(a.replace(this._matchEntityOrChar,this._letter.openSpaceTag+"$&"+this._letter.closeTag)),this._isInSpace||(b.push(this._word.openTag),this._isInWord=!0)):(this._isInWord||(b.push(this._word.openTag),this._isInWord=!0),b.push(a.replace(this._matchEntityOrChar,this._letter.openTag+"$&"+this._letter.closeTag)))},_trimRedundantSpaces:function(a){return a=a.replace(this._matchCarriageReturns,""),a=a.replace(this._matchDoubleSpaces," ")}})}),define.experiment.component("wysiwyg.common.components.DeadComponent.NBC_RenderOnlyDisplayed",function(a){var b=a;b.methods({setSkin:function(a){this.parent(a),this.$view.setAttribute("skin",this.__oldSkin),this.$view.setAttribute("styleid",this.__oldStyleId),this.$view.setAttribute("comp",this.__oldCompId)},_onRender:function(a){var b=a.data.invalidations;if(b.isInvalidated([this.INVALIDATIONS.SKIN_CHANGE])&&(this._messageToUser?this._setTextsFromArgs():this.resources.W.Config.env.$isEditorViewerFrame&&this.resources.W.Config.env.isInIframeInEditor()&&this._setTextsFromResources(window.top.W.Resources)),b.isInvalidated([this.INVALIDATIONS.WIDTH_REQUEST,this.INVALIDATIONS.HEIGHT_REQUEST,this.INVALIDATIONS.FIRST_RENDER])){var c=this.getRequestDimensions();this.$view.setStyles({width:c.width+"px",height:c.height+"px"})}}})}),define.experiment.component("wysiwyg.common.components.exitmobilemode.viewer.ExitMobileMode.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},mobile:{custom:[],isTextScalable:!0,forceRemoveIconOnHide:!0,disablePropertySplit:!0,dontOpenPanelOnDelete:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.newComponent("wysiwyg.common.components.exitmobilemode.viewer.ExitMobileMode.ExitMobileMode",function(a){var b=a;b.inherits("wysiwyg.viewer.components.SiteButton"),b.traits(["wysiwyg.viewer.components.traits.CustomPreviewBehavior"]),b.resources(["W.Viewer","W.Commands"]),b.propertiesSchemaType("ButtonProperties"),b.skinParts({label:{type:"htmlElement"},link:{type:"htmlElement"}}),b.binds(["_onSiteReady"]),b.fields({EDITOR_META_DATA:{general:{settings:!0,design:!1},mobile:{custom:[],isTextScalable:!0,forceRemoveIconOnHide:!0,disablePropertySplit:!0,dontOpenPanelOnDelete:!0}}}),b.methods({_onClick:function(a){return this.isEnabled()&&W.Config.env.$isPublicViewerFrame&&this._exitMobileMode(),this._cancelEvent(a)},_onRender:function(){this.parent(),this._createClickOverlayForPreviewMode("MOBILE_EXIT_MOBILE_BUTTON_PREVIEW_CLICK_OVERLAY_ttid")},_exitMobileMode:function(){var a=this.resources.W.Viewer;a.getSiteNode().$logic.collapse(),W.Config.env.$viewingDevice!==Constants.ViewerTypesParams.TYPES.DESKTOP&&(a.initiateSite(Constants.ViewerTypesParams.TYPES.DESKTOP),a.getSiteView(Constants.ViewerTypesParams.TYPES.DESKTOP).addEvent("SiteReady",this._onSiteReady))},_onSiteReady:function(){var a=this.resources.W.Viewer;a.getSiteView(Constants.ViewerTypesParams.TYPES.DESKTOP).removeEvent("SiteReady",this._onSiteReady),a.getSiteView(Constants.ViewerTypesParams.TYPES.DESKTOP).changePageWithTransition(a.getCurrentPageId())},_createComponentProperties:function(){this.parent(),this._properties.setIsPersistent(!0)}})}),define.skin("wysiwyg.common.components.exitmobilemode.viewer.skins.ExitMobileModeSkin",function(a){var b=a;b.inherits("mobile.core.skins.BaseSkin"),b.skinParams([{id:"clr",type:Constants.SkinParamTypes.COLOR,defaultTheme:"color_13"},{id:"fnt",type:Constants.SkinParamTypes.FONT,defaultTheme:"font_8"},{id:"pos",type:Constants.SkinParamTypes.OTHER,defaultValue:"position:absolute; top:0px; bottom:0px; left:0px; right:0px;"}]),b.html('<a skinPart="link"><span skinPart="label"></span></a>'),b.css(["%link%    { [pos] }","%label%   { [fnt]color:[clr]; white-space:nowrap; text-decoration:underline; }"])}),define.experiment.component("wysiwyg.common.components.inputs.OptionsListInput.ChangeGallery",function(a,b){var c=a;c.methods({_getItemByIndex:function(a){return this.items&&this.items[a]&&this.items[a].getLogic()},setSelectedItemByIndex:function(a){this._changeSelectedItem(this._getItemByIndex(a))}})}),define.experiment.newComponent("wysiwyg.common.components.inputs.OptionsListsContainer",function(a){var b=a;b.inherits("core.components.base.BaseComp"),b.traits(["wysiwyg.viewer.components.traits.ValidationSettings"]),b.utilize(["wysiwyg.viewer.utils.ComponentSequencer"]),b.binds(["_onItemSelected"]),b.states({validity:["valid","invalid"]}),b.fields({_selectedItem:null}),b.dataTypes(["SelectableList"]),b.resources(["W.Data"]),b.methods({initialize:function(a,b,c){this.parent(a,b,c),this._sequencer=new this.imports.ComponentSequencer,c&&(this._allowOptionReselect=c.allowOptionReselect,this._sequencer.resolveItem=function(){var a={comp:c.compType,skin:c.compSkin};return c.compStyleId&&(a.styleId=c.compStyleId),a})},_onAllSkinPartsReady:function(){},_onDataChange:function(a,b,c){if("selected"===b){var d=this._getSelectedComponentByData(c[b]);this._changeSelectedItem(d)}this.parent(a,b,c)},_getSelectedComponentByData:function(a){var b=this.items.map(function(a){return a.$logic}),c=b.filter(function(b){return b.getDataItem()==a});return c&&c[0]},_getFirstFilteredDataItem:function(a){var b=_.map(this.items,function(a){return a.$logic.getDataItem()}),c=_.filter(b,a);return c&&c[0]},getDataItemByLabel:function(a){var b=a.toLowerCase();return this._getFirstFilteredDataItem(function(a){return a.get("label").toLowerCase()===b})},getDataItemByLabelStartingWith:function(a){var b=a.toLowerCase();return this._getFirstFilteredDataItem(function(a){return 0===a.get("label").toLowerCase().indexOf(b)})},scrollToByDataItem:function(a){this.$view.scrollTop=this._getComponentHeightByData(a)},_getComponentHeightByData:function(a){for(var b=0,c=0;c<this.items.length;c++){var d=this.items[c];if(d.$logic.getDataItem()===a)return b;b+=d.getHeight()}return 0},_preventRenderOnDataChange:function(a,b){return"selected"===b},_prepareForRender:function(){return this._sequencer.addEvent("productionFinished",function(a){this._onSequencerFinished(a),this.fireEvent("optionListInputReady",a)}.bind(this)),this._sequencer.createComponents(this.getViewNode(),this.getDataItem().get("items")),!0},_onSequencerFinished:function(a){this.items=a.elements,this.items.forEach(function(a){var b=a.getLogic();b.addEvent("itemSelected",this._onItemSelected),b.getDataItem()===this.getDataItem().get("selected")&&(this._selectedItem=b,this._selectedItem.setSelected(!0))}.bind(this))},_onItemSelected:function(a){if(!this._selectedItem||this._selectedItem!==a||this._allowOptionReselect){var b=a.getDataItem();this.setValidationState(!0),this.getDataItem().set("selected",b),this.fireEvent("selectionChanged",b)}},_changeSelectedItem:function(a){this._selectedItem&&this._selectedItem.setSelected(!1),a&&(this._selectedItem=a,this._selectedItem.setSelected(!0),this._selectedItem.getViewNode().focus())},setValidationState:function(a){this.setState(a?"valid":"invalid","validity"),this.parent(a)}})}),define.experiment.newComponent("wysiwyg.common.components.onlineclock.viewer.OnlineClock.OnlineClock",function(a){var b=a;b.inherits("core.components.base.BaseComp"),b.propertiesSchemaType("OnlineClockProperties"),b.dataTypes(["OnlineClock"]),b.skinParts({time:{type:"htmlElement"},date:{type:"htmlElement"}}),b.states({}),b.binds(["_tick"]),b.fields({_timer:null,_short_format:!1,_colon_visible:!0}),b.methods({initialize:function(a,b,c){this.parent(a,b,c)},_onFirstRender:function(){},_onEachRender:function(){this._restartClock()},_onRender:function(a){a.data.invalidations.isInvalidated([this.INVALIDATIONS.FIRST_RENDER])&&this._onFirstRender(),this._onEachRender()},isRenderNeeded:function(a){var b=[this.INVALIDATIONS.FIRST_RENDER,this.INVALIDATIONS.DATA_CHANGE,this.INVALIDATIONS.STYLE_PARAM_CHANGE];return a.isInvalidated(b)},_restartClock:function(){this._timer&&clearInterval(this._timer),this._formatTime=this._makeTimeFormatter(this.getComponentProperties().get("timeFormat")),this._formatDate=this._makeDateFormatter(this.getComponentProperties().get("dateFormat")),this.getComponentProperties().get("showDate")?this._skinParts.date.removeClass("hidden"):this._skinParts.date.addClass("hidden"),this._tick(),this.setWidth(this._skinParts.time.offsetWidth),this.setHeight(15),this._timer=setInterval(this._tick,1e3)},_tick:function(){var a=this._getDate();if(this._skinParts.time.innerHTML=this._formatTime(a),this._skinParts.date.hasClass("hidden")||(this._skinParts.date.innerHTML=this._formatDate(a)),this._short_format){var b=this._skinParts.time.getElement(".colon");this._colon_visible?b.removeClass("invisible"):b.addClass("invisible"),this._colon_visible=!this._colon_visible}},_formatNumber:function(a){return("0"+a).slice(-2)},_formatTime:function(){return""},_formatDate:function(){return""},_getDate:function(){var a=new Date,b=a.getTime()+6e4*a.getTimezoneOffset();return a.setTime(b+6e4*this.getDataItem().get("timeZone")),a},_makeTimeFormatter:function(a){a=a.split("_"),this._short_format="short"==a[0];var b,c="12"==a[1],d=this._short_format?"HH:MM":"HH:MM:SS",e=function(a,b,c){var e={HH:'<span class="hours">'+this._formatNumber(a)+"</span>",MM:'<span class="minutes">'+this._formatNumber(b)+"</span>",SS:'<span class="seconds">'+this._formatNumber(c)+"</span>",":":'<span class="colon">:</span>'};return d.replace(new RegExp(Object.keys(e).join("|"),"gi"),function(a){return e[a]})}.bind(this);return b=c?function(a){var b=a.getHours(),c=!0;return b>11&&(b-=12,c=!1),e(b||12,a.getMinutes(),a.getSeconds())+'<span class="ampm">'+(c?"AM":"PM")+"</span>"}:function(a){return e(a.getHours(),a.getMinutes(),a.getSeconds())}},_makeDateFormatter:function(a){var b=["January","February","March","April","May","June","July","August","September","October","November","December"],c={monthfirst:function(a){return b[a.getMonth()]+", "+a.getDate()},datefirst:function(a){return a.getDate()+", "+b[a.getMonth()]},monthfirstshort:function(a){return b[a.getMonth()].slice(0,3)+'<span class="slash">/</span>'+a.getDate()},datefirstshort:function(a){return a.getDate()+'<span class="slash">/</span>'+b[a.getMonth()].slice(0,3)}};return c[a]}})}),define.experiment.newDataSchema("OnlineClock.OnlineClock",function(){return{timeZone:{type:"string","default":""}}}),define.experiment.newDataSchema("OnlineClockProperties.OnlineClock",function(){return{timeFormat:{type:"string","enum":["full_24","short_24","full_12","short_12"],"default":"full_24"},showDate:{type:"boolean","default":"true"},dateFormat:{type:"string","enum":["monthfirst","datefirst","monthfirstshort","datefirstshort"],"default":"monthfirst"}}}),define.experiment.component("wysiwyg.common.components.pinterestpinit.viewer.PinterestPinIt.PinterestPinItRevised",function(a){var b=a;b.methods({_generateIframeUrl:function(a){var b,c,d,e,f=this.resources.topology.wysiwyg+"/html/external/pinterestpin.html";return a?(b=this.getDataItem(),c=this.getComponentProperties(),d=c.get("size"),e={media:this._getImageUrl(),url:this._getSiteUrl(),description:b.get("description"),"data-pin-config":c.get("counterPosition"),"data-pin-color":c.get("color"),"data-pin-height":this._pinButtonSizes.none[d].height}):e={gagPath:this.resources.W.Theme.getProperty("WEB_THEME_DIRECTORY")+"pinterestPinIt/pinterest_disabled.png"},f+"?"+Object.toQueryString(e)}})}),define.experiment.Class("wysiwyg.common.utils.TextMigrationHandler.RichTextMigrationStudio",function(a){var b=a;b.methods({migrateComponent:function(a){this._changeData(a),this._changeSkin(a);var b=a.getDataItem();if(b&&b.get("text")){var c=this.migrateText(b.get("text"),null,null);return this._hasStyleOverrides&&a.getViewNode().addClass("hasOverrides"),c}return null},migrateText:function(a,b,c){if(this._hasStyleOverrides=!1,b=b||"p",c=c||"font_8","string"!==typeOf(a))return null;if(""===a)return'<{0} class="{1}"></{0}>'.substitute([b,c]);var d=new Element("div");return d.set("html",a),this._hasStyleOverrides=this._stylesMigration.migrateElement(d,b,c),this._simpleMigration.migrateElement(d),d.get("html")}})}),define.experiment.Class("wysiwyg.common.utils.TextStylesMigration.RichTextMigrationStudio",function(a){var b=a;b.methods({migrateElement:function(a,b,c){this._hasStyleOverrides=!1;var d=[],e=this._domHelper.collectionToArray(a.childNodes);return e.forEach(function(a){if(this._domHelper.isBlockElement(a)){d.length>0&&(this._applyStyleOnElements(d,b,c),d=[]);var e=!this._changeableTagList.contains(a.tagName.toLowerCase())||this._domHelper.hasBlockElementChildren(a);e?this.migrateElement(a,b,c):this._applyStyleOnBlock(a,b,c)}else d.push(a)},this),d.length>0&&this._applyStyleOnElements(d,b,c),this._hasStyleOverrides},_moveInlineStyleFromOriginalElementToBlockParentElement:function(a,b){var c=this._viewer.theme.getProperty(b),d="core.utils.css.Font"===c.getOriginalClassName();return d&&(a=this._setBlockElementTagAccordingToStyle(a,b)),a},_removeStyleClassesReplaceWithInline:function(a,b){b.map(function(b){var c=this._stylesHelper.getElementStyleClass(b);if(c==a)0===b.childNodes.length?b.destroy():this._removeStyleFromSpan(b,a);else{this._domHelper.removeClass(b,c),0===b.getProperty("class").length&&b.removeAttribute("class");var d=this._setStyleOverrides(a,c,b);d&&(this._hasStyleOverrides=!0)}},this)},_removeStyleFromSpan:function(a,b){a.removeClass(b),this._domHelper.isElementHasAttributes(a)||this._domHelper.replaceElementWithItsChildren(a)},_setStyleOverrides:function(a,b,c){var d=!1,e=this._stylesHelper.getStyleDelta(a,b),f=c;Object.forEach(e,function(a,b){f.setStyle(b,a),d=!0});var g=this._stylesHelper.getColorDelta(a,b);return g?(g.isRef?(f.addClass(g.value),d=!0):(f.setStyle("color",g.value),d=!0),d):d}})}),define.experiment.newComponent("wysiwyg.common.components.weather.viewer.Weather.Weather.New",function(a){var b=a;b.inherits("core.components.base.BaseComp"),b.propertiesSchemaType("WeatherProperties"),b.utilize(["wysiwyg.common.components.weather.viewer.utils.WeatherUtils"]),b.skinParts({degreesBox:{type:"htmlElement"},degreesValue:{type:"htmlElement"},degreesUnit:{type:"htmlElement"}}),b.fields({EDITOR_META_DATA:{general:{settings:!0,design:!0}},degrees:null}),b.statics({UNIT_MAP:{fahrenheit:"F",celsius:"C"},_resizableSides:[],_logEnabled:!1,_weatherUtils:null}),b.methods({initialize:function(a,b,c){this.setMinW(60),this.parent(a,b,c),this._weatherUtils=new this.imports.WeatherUtils},_onDataChange:function(a,b){var c=this.getComponentProperties();if(this._isFieldChanged(a,"locationId")||b.all){this._displayTemperature("","");var d=c.get("locationId");this._log("Location changed: "+d),d&&this._fetchWeatherData(d).then(function(a){if(this.degrees=a.degrees,null!==this.degrees){this._log("Fetched: "+this.degrees+" for "+a.location);var b=c.get("degreesUnit");this._displayTemperature(this.degrees,b)}}.bind(this))}if((this._isFieldChanged(a,"degreesUnit")||b.all)&&null!==this.degrees){var e=c.get("degreesUnit");e&&null!==this.degrees&&this._displayTemperature(this.degrees,e)}},_displayTemperature:function(a,b){this._log("Unit: "+b),b&&null!==a&&void 0!==a?(this._skinParts.degreesValue.innerHTML=this._setTemperatureSign(this._convertTemperature(a,b)),this._skinParts.degreesUnit.innerHTML=this.UNIT_MAP[b]):(this._skinParts.degreesUnit.innerHTML="",this._skinParts.degreesValue.innerHTML=""),this.setWidth(this._skinParts.degreesBox.offsetWidth)},_isFieldChanged:function(a,b){return!!_.find(a.data.invalidations._invalidations.dataChange,function(a){return a.field===b||void 0===a.field})},_fetchWeatherData:function(a){if(!a)return Q.reject();var b=Q.defer(),c="http://api.openweathermap.org/data/2.5/weather?id="+a+"&mode=json";return this._weatherUtils.fetchRemoteData(c,"GET").then(function(a){b.resolve({degrees:a.main.temp,location:a.name})},function(a){b.reject(a)}),this._log("Started to load weather data"),b.promise},_onRender:function(a){a.data.invalidations.isInvalidated([this.INVALIDATIONS.SKIN_CHANGE])?this._onDataChange(a,{all:!0}):a.data.invalidations.isInvalidated([this.INVALIDATIONS.FIRST_RENDER,this.INVALIDATIONS.PROPERTIES_CHANGE])&&this._onDataChange(a,{})},_convertTemperature:function(a,b){if(null===a||void 0===a)return null;var c;if("celsius"===b)c=a-273.15;else{if("fahrenheit"!==b)throw new Error("Unknown target unit "+b);c=1.8*(a-273)+32}return c},_setTemperatureSign:function(a){return a=Math.round(a),0>a?"-"+Number.toFixed(Math.abs(a),0):a>0?"+"+Number.toFixed(Math.abs(a),0):"0"},_log:function(a){this._logEnabled&&console.log(a)}})}),define.experiment.newDataSchema("Weather.Weather.New",function(){return{}}),define.experiment.newDataSchema("WeatherProperties.Weather.New",function(){return{degreesUnit:{type:"string","enum":["fahrenheit","celsius"],"default":"fahrenheit"},locationId:"string",locationName:"string"}}),define.experiment.newClass("wysiwyg.common.components.weather.viewer.utils.WeatherUtils.Weather.New",function(a){a.methods({fetchRemoteData:function(a,b){function c(){try{var a=JSON.parse(e.responseText);d.resolve(a)}catch(b){d.reject({code:-1,description:"failed to parse json"})}}b=b||"GET";var d=Q.defer(),e="XDomainRequest"in window?new window.XDomainRequest:new window.XMLHttpRequest;return e.open(b,a,!0),e.onreadystatechange=function(){4===e.readyState&&(200===e.status?c():d.reject({code:e.status}))}.bind(this),e.onload=c.bind(this),e.onerror=function(){d.reject({code:e.responseText})},e.send(null),d.promise}})}),define.experiment.component("wysiwyg.common.components.youtubesubscribebutton.viewer.YouTubeSubscribeButton.YouTubeFixes",function(a,b){var c=a,d=b;c.binds(["_onMouseOut","_onMouseOver"]),c.states({hoverMode:["hover","nonHover"],layout:["full","default","fullIE","defaultIE"]}),c.statics({_defaultLayoutWidth:145,_defaultLayoutHeight:33,_fullLayoutWidth:212,_fullLayoutHeight:55,_fullLayoutHeightIE:67,_toolTipExtraSpace:60,_toolTipWidthExtraSpaceDefault:150,_toolTipWidthExtraSpaceFull:150}),c.methods({initialize:d.after(function(){W.Utils.isIE()&&(this._fullLayoutHeight=this._fullLayoutHeightIE)}),_onRender:d.before(function(a){var b=a.data.invalidations,c=this.getComponentProperties().getData();this.setState("nonHover","hoverMode"),b.isInvalidated([this.INVALIDATIONS.SKIN_CHANGE,this.INVALIDATIONS.DATA_CHANGE])&&("default"===c.layout?(this.setMinW(this._defaultLayoutWidth),this.setMinH(this._defaultLayoutHeight),this.setHeight(this._defaultLayoutHeight+"px")):(this.setMinW(this._fullLayoutWidth),this.setMinH(this._fullLayoutHeight),this.setHeight(this._fullLayoutHeight+"px")))}),isRenderNeeded:function(a){var b=[this.INVALIDATIONS.SKIN_CHANGE,this.INVALIDATIONS.DATA_CHANGE,this.INVALIDATIONS.SIZE];return a.isInvalidated(b)},_getIframeDimensions:function(a){var b,c,d=this.resources.W.Config.env.$viewingDevice,e=this.getComponentProperties().getData();return"default"===e.layout?(Browser.ie?this.setState("defaultIE","layout"):this.setState("default","layout"),b=this.getWidth(),c=this.getHeight(),d===Constants.ViewerTypesParams.TYPES.DESKTOP&&a&&(c+=this._toolTipExtraSpace,b+=this._toolTipWidthExtraSpaceDefault)):(Browser.ie?this.setState("fullIE","layout"):this.setState("full","layout"),b=this.getWidth(),c=this.getHeight(),d===Constants.ViewerTypesParams.TYPES.DESKTOP&&a&&(c+=this._toolTipExtraSpace,b+=this._toolTipWidthExtraSpaceFull)),{width:b+"px",height:c+"px"}},_createIframe:function(){var a=this._getIframeDimensions();this._iframe=new IFrame({src:this._getIframeUrl(),webkitAllowFullScreen:"true",mozallowfullscreen:"true",allowfullscreen:"allowfullscreen",frameborder:"0",width:"100%",height:"100%"}),this._removePreviousIframesElements(),this._skinParts.youtubeIframe.style.height=a.height,this._skinParts.youtubeIframe.style.width=a.width,this._skinParts.hitWidth.style.left=a.width,this._iframe.insertInto(this._skinParts.youtubeIframe),this._iframe.addEvent(Constants.CoreEvents.MOUSE_OVER,this._onMouseOver),this._iframe.addEvent(Constants.CoreEvents.MOUSE_OUT,this._onMouseOut)},_onMouseOver:function(){var a=this._getIframeDimensions(!0);this.setState("hover","hoverMode"),this._skinParts.youtubeIframe.style.height=a.height,this._skinParts.youtubeIframe.style.width=a.width},_onMouseOut:function(){var a=this._getIframeDimensions();this.setState("nonHover","hoverMode"),this._skinParts.youtubeIframe.style.height=a.height,this._skinParts.youtubeIframe.style.width=a.width},_removePreviousIframesElements:function(){for(var a=Array.from(this._skinParts.youtubeIframe.childNodes),b=0;b<a.length;b++){var c=a[b];c&&"IFRAME"==c.nodeName&&c.parentElement.removeChild(c)}}})}),define.experiment.dataSchema("YouTubeSubscribeButtonProperties.YouTubeFixes",function(a){var b=a;return b.customizeField(function(a){return a.layout["default"]="full",a})}),define.experiment.skin("wysiwyg.common.components.youtubesubscribebutton.viewer.skins.YouTubeSubscribeButtonSkin.YouTubeFixes",function(a){var b=a;b.inherits("core.managers.skin.BaseSkin2"),b.skinParams([]),b.html('<div skinPart="youtubeIframe"><div skinPart="hitWidth" class="hitOutVertical"></div><div class="hitOutHorizontal"></div></div>'),b.css(["%youtubeIframe% {height: 66px;display:inline-block;position:absolute;font-size:0;line-height:0;}","[state~=nonHover]  %youtubeIframe% { z-index:0;}","[state~=hover] %youtubeIframe% { z-index:2; }","%.hitOutVertical%   {  right:0px;position:absolute;  height:100%;z-index:10;}","%.hitOutHorizontal% { bottom:0px;position:absolute; width:100%;z-index:10;}","[state~=default] %.hitOutVertical%   { left:130px}","[state~=default] %.hitOutHorizontal% { top:33px}","[state~=full] %.hitOutVertical%      { left:190px;height:53px}","[state~=full] %.hitOutHorizontal%    { top:55px;}","[state~=defaultIE] %.hitOutVertical%   { left:141px}","[state~=defaultIE] %.hitOutHorizontal% { top:38px}","[state~=fullIE] %.hitOutVertical%      { left:202px;height:65px}","[state~=fullIE] %.hitOutHorizontal%    { top:67px;}"])}),define.experiment.newDataSchema("LoginButton.SiteMemberTranslated",function(){return{language:{type:"string","default":""}}}),define.experiment.newClass("wysiwyg.managers.SocialActivityManager.SocialActivity.New",function(a){var b={sheet:function(a){if(!this.styleSheet){var b=a.createElement("style");b.appendChild(a.createTextNode("")),a.head.appendChild(b),this.styleSheet=b.sheet}return this.styleSheet},addCSSRule:function(a,b,c,d){var e=this.sheet(a);console.log(e),e.insertRule?e.insertRule(b+"{"+c+"}",d):e.addRule(b,c,d)},resetStyles:function(a){for(var b=0;b<this.styleSheet.rules.length;b++)this.styleSheet.rules[b].selectorText.indexOf(a)>=0&&this.styleSheet.removeRule(b)}};a.inherits("bootstrap.managers.BaseManager"),a.utilize(["core.components.image.ImageUrlNew"]),a.statics({defaultPreset:null,_socialBarActiveComponents:null,_activeComponents:{},_stylesAppended:!1,_document:null,THEME_NAMES:{"default":"dark",light:"light"}}),a.methods({initialize:function(){this.defaultPreset=this.getDefaultPreset(),this._socialBarActiveComponents=this._getDataFromLocalStorage(),this.serverAddress=new this.imports.ImageUrlNew,$("live-preview-iframe")?resource.getResources(["W.Editor","W.Preview","W.Commands","W.Theme"],function(a){console.log("editor"),this._resources=a,this._compFactory=this._resources.W.Preview,this._resources.W.Commands.registerCommandAndListener("PreviewIsReady",this,this._init)}.bind(this)):resource.getResources(["W.Viewer","W.Commands","W.Theme"],function(a){console.log("viewer"),this._resources=a,this._compFactory=this._resources.W.Viewer,this._init()}.bind(this))},_init:function(){var a=this;Object.keys(a._socialBarActiveComponents).forEach(function(b){a.addSBarToComponent(b)}),this._isReady=!0},getDefaultPreset:function(){return{activeNetworks:{fb:!0,tw:!0,pi:!0},iconSize:25,showCondition:1,theme:"default"}},_getComponentById:function(a){return this._compFactory.getCompLogicById(a)},_getDataFromLocalStorage:function(){var a;return a=(a=localStorage.getItem("SocialActivity.activeComponents"))?JSON.parse(a):{}},_setDataToLocalStorage:function(){localStorage.setItem("SocialActivity.activeComponents",JSON.stringify(this._socialBarActiveComponents))},isComponentSocialActive:function(a){return a in this._socialBarActiveComponents},getComponentSBsrSettings:function(a){return a&&this.isComponentSocialActive(a)?a in this._socialBarActiveComponents&&""!==this._socialBarActiveComponents[a]?this._socialBarActiveComponents[a]:this.getDefaultPreset():this.getDefaultPreset()},turnOnOffComponentSocialActivity:function(a,b){a&&(!this.isComponentSocialActive(a)&&b?(this._socialBarActiveComponents[a]="",this.addSBarToComponent(a)):!b&&this.isComponentSocialActive(a)&&(this.removeSBarFromComponent(a),delete this._socialBarActiveComponents[a]),this._setDataToLocalStorage())},isComponentTurnedOn:function(a){return a in this._activeComponents},addSBarToComponent:function(a){if(console.log(this.isComponentSocialActive(a),a),this.isComponentSocialActive(a)&&!this.isComponentTurnedOn(a))if(W.Config.env.$isPublicViewerFrame)setTimeout(function(){var b=this._getComponentById(a);b&&b.on(Constants.LifecycleSteps.RENDER,this,this._onRender),console.log("Add",b),this._activeComponents[a]=!0}.bind(this),0);else{var b=this._getComponentById(a);b&&b.on(Constants.LifecycleSteps.RENDER,this,this._onRender),b&&this.buildSocialBar(b),this._activeComponents[a]=!0}},removeSBarFromComponent:function(a){var b=this._getComponentById(a);console.log("remove",b),b&&b.off(Constants.LifecycleSteps.RENDER,this,this._onRender),b&&this._removeSocialBar(b),delete this._activeComponents[a]},_onRender:function(a){var b=a.target,c=a.data.invalidations._invalidations;("firstRender"in c||"skinChange"in c)&&this.buildSocialBar(b)},buildSocialBar:function(a,c){this._removeSocialBar(a);var d=$("live-preview-iframe")?$("live-preview-iframe").contentDocument:document;this._stylesAppended||(b.addCSSRule(d,".socialActivityBar","position: absolute; bottom: 10px; right: 10px;"),b.addCSSRule(d,".socialActivityBar li","display: inline-block; list-style:none; width: 25px; height: 25px; background: transparent no-repeat right center; background-size: 100%; margin-right: 3px"),this._stylesAppended=!0);var e=c||this.getComponentSBsrSettings(a.getComponentId()),f=a._view,g=this,h=document.createElement("ul");h.addClass("socialActivityBar"),Object.keys(e.activeNetworks).forEach(function(b){var c=document.createElement("li");h.appendChild(c),c.style.backgroundImage="url("+this.getIconsLink(b,e.theme)+")",function(a,b){c.addEventListener("click",function(){g._socialAction(a,b,g.serverAddress)},!1)}(b,a)}.bind(this)),"2"==e.showCondition&&(b.addCSSRule(d,"#"+a.getComponentId()+" .socialActivityBar","display: none;"),b.addCSSRule(d,"#"+a.getComponentId()+":hover .socialActivityBar","display: block;")),b.addCSSRule(d,"#"+a.getComponentId()+" .socialActivityBar li","height: "+e.iconSize+"px; width: "+e.iconSize+"px"),a.sBar=h,f.appendChild(h)},_removeSocialBar:function(a){a.sBar&&(a.sBar.dispose(),b.resetStyles(a.getComponentId()),delete a.sBar)},getIconsLink:function(a,b){var c=this._resources.W.Theme.getProperty("WEB_THEME_DIRECTORY");return c=c.replace("viewer","editor_web"),[c,"social_activity",a+"_"+this.THEME_NAMES[b]+".png"].join("/")},saveData:function(a,b){b in this._socialBarActiveComponents&&(this._socialBarActiveComponents[b]=a,this._setDataToLocalStorage(),this.buildSocialBar(this._getComponentById(b)))},_socialAction:function(a,b,c){var d={};"Image"===b.getDataItem()._dataType&&(d.image=c.getImageAbsoluteUrlFromRelativeUrl(b.getDataItem()._data.uri),d.title=b.getDataItem()._data.title,d.description=b.getDataItem()._data.description);var e="",f={fb:function(){e="https://www.facebook.com/sharer/sharer.php?u="+d.image+"&t="+d.title},tw:function(){e="http://www.twitter.com/intent/tweet?url="+d.image+"&via=wix.com&text="+d.title},pi:function(){e="http://www.pinterest.com/pin/create/button/?media="+d.image+"&description="+d.description}};f[a]&&(f[a](b),window.open(e,"newwindow","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width=585,height=368"))}})}),define.experiment.newDataSchema("TinyMenuProperties.TinyTextAlign",function(){return{direction:{"enum":["left","center","right"],type:"string","default":"left"}}}),define.experiment.newDataSchema("WRichTextProperties.MobileTextBrightness",function(){return{brightness:{type:"number","default":1}}}),define.experiment.Class("wysiwyg.common.utils.LinkRenderer.CustomMenu",function(a){var b=a;b.methods({renderLinkDataItemForCustomMenu:function(a){var b=a&&a.getType?a.getType().toLowerCase():"",c=this._getPreviewDataManager();
switch(b){case"externallink":return this._renderExternalLinkForCustomMenu(a,c);case"pagelink":return this._renderPageLinkForCustomMenu(a,c);case"anchorlink":return this._renderAnchorLinkForCustomMenu(a,c);case"emaillink":return this._renderEmailLinkForCustomMenu(a,c);case"documentlink":return this._renderDocumentLinkForCustomMenu(a,c);case"logintowixlink":return this._renderLoginToWixLinkForCustomMenu(a,c);default:return""}},_renderExternalLinkForCustomMenu:function(a){return this.renderExternalLink(a)},_renderPageLinkForCustomMenu:function(a,b){var c=a.get("pageId"),d=b.getDataByQuery(c);return d?d.get("title"):this.renderPageLink(a)},_renderAnchorLinkForCustomMenu:function(a,b){var c=a.get("anchorDataId"),d=c.indexOf("SCROLL")<0&&b.getDataByQuery(c);return d?d.get("name"):a.get("anchorName")},_renderEmailLinkForCustomMenu:function(a){return a.get("recipient")},_renderDocumentLinkForCustomMenu:function(a){return a.get("name")},_renderLoginToWixLinkForCustomMenu:function(){return"Login / Signup Dialog"}})}),define.experiment.Class("wysiwyg.common.utils.OpenPanelByQuery.OpenMarketSearch",function(a){a.methods({_filterQueryValue:function(a){return a.indexOf(":")>-1&&(a=a.split(":")[0]||a),a},_executeMarketCommand:function(){var a={};if(this._query.openpanel){var b=this._query.openpanel.split(":");2===b.length?a.searchTag=b[1]:3===b.length?a.appDefIdTag=b[2]:a={searchTag:""}}this.resources.W.Commands.executeCommand("WEditorCommands.Market",a)}})}),define.experiment.newClass("wysiwyg.common.utils.TextCalculator.MobileTextBrightness",function(a){var b=a;b.resources(["W.Utils"]),b.methods({getTextOverallBorders:function(a){var b,c=a.getViewNode();if(c.isVisible())b=c;else{var b=c.clone();this.getSiteNode().adopt(b)}var d=this.getEffectiveTextLayout(b);if(!d||0==d.length)return c.isVisible()||b.dispose(),d;for(var e=Number.MAX_VALUE,f=-Number.MAX_VALUE,g=Number.MAX_VALUE,h=-Number.MAX_VALUE,i=0;i<d.length;i++){var j=d[i];e=Math.min(e,j.top),f=Math.max(f,j.bottom),g=Math.min(g,j.left),h=Math.max(h,j.right)}var k=a.getViewNode().getParent("[comp]"),l=this.getNodeGlobalPosition(k),m={x:Math.round(g),y:Math.round(e)+window.pageYOffset,width:Math.round(h)-Math.round(g),height:Math.round(f)-Math.round(e)};return c.isVisible()?(m.y=m.y-(l.y-this.getPositionOffset().y),m.x=m.x-(l.x-this.getPositionOffset().x)):(m.x=m.x-this.getSiteNode().getPosition().x,b.dispose()),m},getNodeGlobalPosition:function(){},getSiteNode:function(){},getPositionOffset:function(){},getEffectiveTextLayout:function(a){var b=this._getSpanRects(a);return b=b.concat(this._getTextOutOfSpanRects(a))},_getSpanRects:function(a){var b=_(a.getElements("span")),c=b.filter(function(a){return 1==a.childNodes.length&&3==a.firstChild.nodeType}).map(function(a){return a.getClientRects()}).value(),d=[];return _.forEach(c,function(a){this._mergeRectsListIntoArray(d,a)}.bind(this)),d},_mergeRectsListIntoArray:function(a,b){_.forEach(b,function(b){a.push(b)})},_getTextOutOfSpanRects:function(a){for(var b=[],c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(this._shouldWrapInSpan(d)){var e=new Element("span");e.set("html",this.resources.W.Utils.htmlEncode(d.data)),this._replaceNode(a,e,d),this._mergeRectsListIntoArray(b,e.getClientRects()),this._replaceNode(a,d,e)}else b=b.concat(this._getTextOutOfSpanRects(d))}return b},_shouldWrapInSpan:function(a){var b=a.parentElement||a.parentNode;return 3===a.nodeType&&("SPAN"!=b.nodeName||b.childNodes.length>1)&&""!=a.data.trim()},_replaceNode:function(a,b,c){a.insertBefore(b,c.nextSibling),a.removeChild(c)}})}),define.experiment.newClass("wysiwyg.common.utils.SiteMemberLanguages.SiteMemberTranslated",function(a){var b=a;b.statics({supportedLanguages:["en","es","de","fr","it","ja","ko","pl","pt","ru","tr"]}),b.methods({_getLanguages:function(a){var b="SITEMEMBERLANGS__",c=this.supportedLanguages.map(function(c){return{label:a._translate(b+c),value:c}});return c}})});